(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{164:function(t,e,i){},165:function(t,e,i){},215:function(t,e,i){"use strict";var s=i(164);i.n(s).a},216:function(t,e,i){"use strict";var s=i(165);i.n(s).a},220:function(t,e,i){"use strict";i.r(e);i(63),i(62),i(64);var s=i(0),r=(i(100),i(163),i(102),i(218)),n=i(209);class h{constructor({id:t,x:e,y:i,width:s,height:r,colWidth:o,rowHeight:a,margin:d,draggable:u,resizable:l,resizeEdges:g,resizeHandleSize:c}){this._moved=!1,this._hover=!1,this.onDragStartEvent=void 0,this.onDragStartLeft=0,this.onDragStartTop=0,this._onDragStartEventDispatcher=new n.SimpleEventDispatcher,this._onDragEventDispatcher=new n.SimpleEventDispatcher,this._onDragEndEventDispatcher=new n.SimpleEventDispatcher,this.onResizeStartEvent=void 0,this.onResizeStartLeft=0,this.onResizeStartTop=0,this.onResizeStartingWidth=0,this.onResizeStartingHeight=0,this._onResizeLocation="",this._onResizeStartEventDispatcher=new n.SimpleEventDispatcher,this._onResizeEventDispatcher=new n.SimpleEventDispatcher,this._onResizeEndEventDispatcher=new n.SimpleEventDispatcher,this._id=t,this._colWidth=void 0!==o?o:1,this._rowHeight=void 0!==a?a:1,this._margin=void 0!==d?d:{x:1,y:1},this._x=void 0!==e?e:h.defaults.x,this._left=h.getLeftFromX(this._x,this._colWidth,this._margin),this._y=void 0!==i?i:h.defaults.y,this._top=h.getTopFromY(this._y,this._rowHeight,this._margin),this._width=void 0!==s?s:h.defaults.width,this._widthPx=h.getWidthInPx(this._width,this._colWidth,this._margin),this._height=void 0!==r?r:h.defaults.height,this._heightPx=h.getHeightInPx(this._height,this._rowHeight,this._margin),this._draggable=void 0!==u?u:h.defaults.draggable,this._resizable=void 0!==l?l:h.defaults.resizable,this._resizeEdges=void 0!==g?g:"top bottom left right",this._resizeHandleSize=void 0!==c?c:8}get id(){return this._id}get x(){return this._x}set x(t){this._x=t,this.updatePositionAndSize()}get y(){return this._y}set y(t){this._y=t,this.updatePositionAndSize()}get colWidth(){return this._colWidth}set colWidth(t){this._colWidth=t,this.updatePositionAndSize()}get rowHeight(){return this._rowHeight}set rowHeight(t){this._rowHeight=t,this.updatePositionAndSize()}get margin(){return this._margin}set margin(t){this._margin=t,this.updatePositionAndSize()}get left(){return this._left}set left(t){this._left=t}get top(){return this._top}set top(t){this._top=t}get width(){return this._width}set width(t){this._width=t,this.updatePositionAndSize()}get height(){return this._height}set height(t){this._height=t,this.updatePositionAndSize()}get widthPx(){return this._widthPx}set widthPx(t){this._widthPx=t}get heightPx(){return this._heightPx}set heightPx(t){this._heightPx=t}get hover(){return this._hover}set hover(t){this._hover=t}updatePositionAndSize(){this.left=h.getLeftFromX(this.x,this.colWidth,this.margin),this.top=h.getTopFromY(this.y,this.rowHeight,this.margin),this.widthPx=h.getWidthInPx(this.width,this.colWidth,this.margin),this.heightPx=h.getHeightInPx(this.height,this.rowHeight,this.margin)}get draggable(){return this._draggable}set draggable(t){this._draggable=t}get resizable(){return this._resizable}set resizable(t){this._resizable=t}get resizeEdges(){return this._resizeEdges}set resizeEdges(t){this._resizeEdges=t}get resizeHandleSize(){return this._resizeHandleSize}set resizeHandleSize(t){this._resizeHandleSize=t}get moved(){return this._moved}set moved(t){this._moved=t}toItem(){return{id:this.id,x:this.x,y:this.y,top:this.top,left:this.left,width:this.width,widthPx:this.widthPx,height:this.height,heightPx:this.heightPx,draggable:this.draggable,resizable:this.resizable}}fromItem(t){this._x=t.x,this._y=t.y,this._width=t.width,this._height=t.height,this.updatePositionAndSize()}_onDragStart(t){t&&t.dataTransfer&&(this.onDragStartEvent=t,t.dataTransfer.setData("text/plain",this.id.toString())),this.onDragStartLeft=this.left,this.onDragStartTop=this.top,this._onDragStartEventDispatcher.dispatch(this.toItem())}_onDrag(t){if(void 0!==this.onDragStartEvent&&t.screenX>0&&t.screenY>0){let e=+this.onDragStartLeft-this.onDragStartEvent.screenX+t.screenX,i=+this.onDragStartTop-this.onDragStartEvent.screenY+t.screenY;this.left=e,this.top=i,this._onDragEventDispatcher.dispatch(this.toItem())}}_onDragEnd(t){t.preventDefault(),this._onDrag(t),this.onDragStartEvent=void 0,this.onDragStartLeft=0,this.onDragStartTop=0,this._onDragEndEventDispatcher.dispatch(this.toItem())}_onMoveStart(){this.onDragStartLeft=this.left,this.onDragStartTop=this.top,this._onDragStartEventDispatcher.dispatch(this.toItem())}_onMove(t,e){this.left=t+this.onDragStartLeft,this.top=e+this.onDragStartTop,this._onDragEventDispatcher.dispatch(this.toItem())}_onMoveEnd(t){this.onDragStartLeft=0,this.onDragStartTop=0,this._onDragEndEventDispatcher.dispatch(this.toItem())}get onDragStart(){return this._onDragStartEventDispatcher.asEvent()}get onDrag(){return this._onDragEventDispatcher.asEvent()}get onDragEnd(){return this._onDragEndEventDispatcher.asEvent()}_onResizeStart2(t,e){this.onResizeStartLeft=this.left,this.onResizeStartTop=this.top,this.onResizeStartingWidth=this.widthPx,this.onResizeStartingHeight=this.heightPx,this._onResizeLocation=e,this._onResizeStartEventDispatcher.dispatch(this.toItem())}_onResizeStart(t,e){t&&t.dataTransfer&&(this.onResizeStartEvent=t,t.dataTransfer.setData("text/plain",this.id.toString())),this.onResizeStartLeft=this.left,this.onResizeStartTop=this.top,this.onResizeStartingWidth=this.widthPx,this.onResizeStartingHeight=this.heightPx,this._onResizeStartEventDispatcher.dispatch(this.toItem())}_onResize2(t,e){let i=this._onResizeLocation;i.includes("right")&&(this.widthPx=t),i.includes("bottom")&&(this.heightPx=e),this._onResizeEventDispatcher.dispatch(this.toItem())}_onResize(t,e){if(e.includes("left")){let e=+this.onResizeStartLeft-this.onResizeStartEvent.screenX+t.screenX;this.left=e;let i=+this.onResizeStartingWidth+this.onResizeStartEvent.screenX-t.screenX;this.widthPx=i}if(e.includes("right")){let e=+this.onResizeStartingWidth-this.onResizeStartEvent.screenX+t.screenX;this.widthPx=e}if(e.includes("top")){let e=+this.onResizeStartTop-this.onResizeStartEvent.screenY+t.screenY;this.top=e;let i=+this.onResizeStartingHeight+this.onResizeStartEvent.screenY-t.screenY;this.heightPx=i}if(e.includes("bottom")){let e=+this.onResizeStartingHeight-this.onResizeStartEvent.screenY+t.screenY;this.heightPx=e}this._onResizeEventDispatcher.dispatch(this.toItem())}_onResizeEnd2(t){this.onResizeStartEvent=void 0,this.onResizeStartLeft=0,this.onResizeStartTop=0,this.onResizeStartingHeight=0,this.onResizeStartingWidth=0,this._onResizeLocation="",this._onResizeEndEventDispatcher.dispatch(this.toItem())}_onResizeEnd(t,e){t.preventDefault(),this._onResize(t,e),this.onResizeStartEvent=void 0,this.onResizeStartLeft=0,this.onResizeStartTop=0,this.onResizeStartingHeight=0,this.onResizeStartingWidth=0,this._onResizeEndEventDispatcher.dispatch(this.toItem())}get onResizeStart(){return this._onResizeStartEventDispatcher.asEvent()}get onResize(){return this._onResizeEventDispatcher.asEvent()}get onResizeEnd(){return this._onResizeEndEventDispatcher.asEvent()}static getLeftFromX(t,e,i){return Math.round(e*t+(t+1)*i.x)}static getXFromLeft(t,e,i){return Math.round((t-i.x)/(e+i.x))}static getTopFromY(t,e,i){return Math.round(e*t+(t+1)*i.y)}static getYFromTop(t,e,i){return Math.round((t-i.y)/(e+i.y))}static getWidthInPx(t,e,i){return Math.round(e*t+Math.max(0,t-1)*i.x)}static getWidthFromPx(t,e,i){return Math.round((t+i.x)/(e+i.x))}static getHeightInPx(t,e,i){return Math.round(e*t+Math.max(0,t-1)*i.y)}static getHeightFromPx(t,e,i){return Math.round((t+i.y)/(e+i.y))}static get defaults(){return{id:"",x:0,y:0,width:1,height:1,draggable:!0,resizable:!0}}static cssTransform(t,e,i,s){const r="translate3d("+e+"px,"+t+"px, 0)";return{transform:r,WebkitTransform:r,MozTransform:r,msTransform:r,OTransform:r,width:i+"px",height:s+"px"}}static cssTopLeft(t,e,i,s){return{top:t+"px",left:e+"px",width:i+"px",height:s+"px"}}}var o=i(214),a=["x","y","width","height"],d={name:"DashItem",inheritAttrs:!1,directives:{displace:o.displace},props:{id:{type:[Number,String],required:!0},x:{type:Number,default:h.defaults.x},y:{type:Number,default:h.defaults.y},width:{type:Number,default:h.defaults.width},height:{type:Number,default:h.defaults.height},draggable:{type:Boolean,default:h.defaults.draggable},resizable:{type:Boolean,default:h.defaults.resizable},resizeEdges:{type:String,default:"bottom right"},resizeHandleSize:{type:Number,default:8},draggableZIndex:{type:Number,default:1},resizableZIndex:{type:Number,default:1}},inject:{$layout:{default:null}},provide:function(){var t=this;return{$item:function(){return t.item}}},data:function(){return{item:null,dragging:!1,resizing:!1,unWatch:null,hover:!1}},computed:{resizingOrDragging:function(){return this.resizing||this.dragging},classObj:function(){return{dragging:this.resizingOrDragging,cssTransforms:this.useCssTransforms}},layout:function(){return this.$layout?this.$layout():null},useCssTransforms:function(){return!!this.layout&&this.layout.useCssTransforms},left:function(){return this.item.left},top:function(){return this.item.top},widthPx:function(){return this.item.widthPx},heightPx:function(){return this.item.heightPx},cssStyle:function(){return this.useCssTransforms?h.cssTransform(this.top,this.left,this.widthPx,this.heightPx):h.cssTopLeft(this.top,this.left,this.widthPx,this.heightPx)},resizeTop:function(){return this.resizeEdges.includes("top")},resizeBottom:function(){return this.resizeEdges.includes("bottom")},resizeLeft:function(){return this.resizeEdges.includes("left")},resizeRight:function(){return this.resizeEdges.includes("right")},resizeTopLeft:function(){return this.resizeTop&&this.resizeLeft},resizeBottomLeft:function(){return this.resizeBottom&&this.resizeLeft},resizeTopRight:function(){return this.resizeTop&&this.resizeRight},resizeBottomRight:function(){return this.resizeBottom&&this.resizeRight}},methods:{ignoreMove:function(){return this.resizing},onMoveStart:function(t){this.dragging=!0,this.item._onMoveStart(t.detail.event),this.$emit("moveStart",Object(r.a)({},this.item.toItem()))},onMove:function(t,e,i){this.dragging&&(this.item._onMove(e,i),this.$emit("moving",Object(r.a)({},this.item.toItem())))},onMoveEnd:function(t){this.item._onMoveEnd(t.detail.event),this.dragging=!1,this.$emit("moveEnd",Object(r.a)({},this.item.toItem()))},onResizeStart:function(t,e){this.resizing=!0,this.item._onResizeStart2(t.detail.event,e),this.$emit("resizeStart",Object(r.a)({},this.item.toItem()))},onResize:function(t,e,i){this.item._onResize2(e,i),this.$emit("resizing",Object(r.a)({},this.item.toItem()))},onResizeEnd:function(t){this.item._onResizeEnd2(t.detail.event),this.$emit("resizeEnd",Object(r.a)({},this.item.toItem())),this.resizing=!1},createPropWatchers:function(){var t=this;Object.keys(this.$props).forEach((function(e){t.$watch(e,function(t,e){return{handler:function(e){this.item[t]!==e&&(this.item[t]=e)},deep:e}}(e,!0))}))},createDashItemWatchers:function(){var t=this;a.forEach((function(e){var i;t.$watch("item."+e,(i=e,{handler:function(t){this.$props[i]!==t&&this.$emit("update:"+i,t)},deep:!0}))}))}},watch:{hover:function(t){this.item.hover=t,t?this.$emit("hoverStart",this.item):this.$emit("hovenEnd",this.item)}},mounted:function(){this.item=new h(this.$props),this.layout?(this.layout.addDashItem(this.item),this.createPropWatchers(),this.createDashItemWatchers()):this.unWatch=this.$watch("layout",(function(t){t&&(this.layout.addDashItem(this.item),this.createPropWatchers(),this.createDashItemWatchers(),this.unWatch())}),{immediate:!0})},beforeDestroy:function(){this.layout&&this.layout.removeDashItem(this.item)}},u=(i(215),i(28)),l=Object(u.a)(d,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return t.item?i("div",{ref:t.id,staticClass:"item",class:t.classObj,style:t.cssStyle,attrs:{id:t.id},on:{mouseover:function(e){t.hover=!0},mouseleave:function(e){t.hover=!1}}},[t.draggable?i("div",{directives:[{name:"displace",rawName:"v-displace",value:{customMove:t.onMove,ignoreFn:t.ignoreMove},expression:"{ customMove: onMove, ignoreFn: ignoreMove }"}],ref:t.id+"-overlay",style:{top:"0px",left:"0px",bottom:"0px",right:"0px",position:"absolute",cursor:"move",zIndex:t.draggableZIndex},attrs:{draggable:"",id:t.id+"-overlay"},on:{onMouseDown:t.onMoveStart,onMouseUp:t.onMoveEnd}},[t.resizeTop&&!t.dragging?i("div",{directives:[{name:"displace",rawName:"v-displace",value:{customMove:t.onResize},expression:"{ customMove: onResize }"}],ref:t.id+"-resizeTop",style:{height:t.resizeHandleSize+"px",left:0,right:0,cursor:"ns-resize",position:"absolute",zIndex:t.resizableZIndex},attrs:{draggable:"",id:t.id+"-resizeTop"},on:{onMouseDown:function(e){return t.onResizeStart(e,"top")},onMouseUp:function(e){return t.onResizeEnd(e)}}},[t._t("resizeTop")],2):t._e(),t._v(" "),t.resizeBottom&&!t.dragging?i("div",{directives:[{name:"displace",rawName:"v-displace",value:{customMove:t.onResize},expression:"{ customMove: onResize }"}],ref:t.id+"-resizeBottom",style:{height:t.resizeHandleSize+"px",left:"0px",right:"0px",bottom:"0px",cursor:"ns-resize",position:"absolute",zIndex:t.resizableZIndex},attrs:{draggable:"",id:t.id+"-resizeBottom"},on:{onMouseDown:function(e){return t.onResizeStart(e,"bottom")},onMouseUp:function(e){return t.onResizeEnd(e)}}},[t._t("resizeBottom")],2):t._e(),t._v(" "),t.resizeLeft&&!t.dragging?i("div",{directives:[{name:"displace",rawName:"v-displace",value:{customMove:t.onResize},expression:"{ customMove: onResize }"}],ref:t.id+"-resizeLeft",style:{width:t.resizeHandleSize+"px",top:"0px",bottom:"0px",left:"0px",cursor:"ew-resize",position:"absolute",zIndex:t.resizableZIndex},attrs:{draggable:"",id:t.id+"-resizeLeft"},on:{onMouseDown:function(e){return t.onResizeStart(e,"left")},onMouseUp:function(e){return t.onResizeEnd(e)}}},[t._t("resizeLeft")],2):t._e(),t._v(" "),t.resizeRight&&!t.dragging?i("div",{directives:[{name:"displace",rawName:"v-displace",value:{customMove:t.onResize},expression:"{ customMove: onResize }"}],ref:t.id+"-resizeRight",style:{width:t.resizeHandleSize+"px",top:"0px",bottom:"0px",right:"0px",cursor:"ew-resize",position:"absolute",zIndex:t.resizableZIndex},attrs:{draggable:"",id:t.id+"-resizeRight"},on:{onMouseDown:function(e){return t.onResizeStart(e,"right")},onMouseUp:function(e){return t.onResizeEnd(e)}}},[t._t("resizeRight")],2):t._e(),t._v(" "),t.resizeTopLeft&&!t.dragging?i("div",{directives:[{name:"displace",rawName:"v-displace",value:{customMove:t.onResize},expression:"{ customMove: onResize }"}],ref:t.id+"-resizeTopLeft",style:{width:2*t.resizeHandleSize+"px",height:2*t.resizeHandleSize+"px",top:t.resizeHandleSize/-2+"px",left:t.resizeHandleSize/-2+"px",cursor:"nw-resize",position:"absolute",zIndex:t.resizableZIndex},attrs:{draggable:"",id:t.id+"-resizeTopLeft"},on:{onMouseDown:function(e){return t.onResizeStart(e,"top left")},onMouseUp:function(e){return t.onResizeEnd(e)}}},[t._t("resizeTopLeft")],2):t._e(),t._v(" "),t.resizeTopRight&&!t.dragging?i("div",{directives:[{name:"displace",rawName:"v-displace",value:{customMove:t.onResize},expression:"{ customMove: onResize }"}],ref:t.id+"-resizeTopRight",style:{width:2*t.resizeHandleSize+"px",height:2*t.resizeHandleSize+"px",top:t.resizeHandleSize/-2+"px",right:t.resizeHandleSize/-2+"px",cursor:"ne-resize",position:"absolute",zIndex:t.resizableZIndex},attrs:{draggable:"",id:t.id+"-resizeTopRight"},on:{onMouseDown:function(e){return t.onResizeStart(e,"top right")},onMouseUp:function(e){return t.onResizeEnd(e)}}},[t._t("resizeTopRight")],2):t._e(),t._v(" "),t.resizeBottomLeft&&!t.dragging?i("div",{directives:[{name:"displace",rawName:"v-displace",value:{customMove:t.onResize},expression:"{ customMove: onResize }"}],ref:t.id+"-resizeBottomLeft",style:{width:2*t.resizeHandleSize+"px",height:2*t.resizeHandleSize+"px",bottom:t.resizeHandleSize/-2+"px",left:t.resizeHandleSize/-2+"px",cursor:"ne-resize",position:"absolute",zIndex:t.resizableZIndex},attrs:{draggable:"",id:t.id+"-resizeBottomLeft"},on:{onMouseDown:function(e){return t.onResizeStart(e,"bottom left")},onMouseUp:function(e){return t.onResizeEnd(e)}}},[t._t("resizeBottomLeft")],2):t._e(),t._v(" "),t.resizeBottomRight&&!t.dragging?i("div",{directives:[{name:"displace",rawName:"v-displace",value:{customMove:t.onResize},expression:"{ customMove: onResize }"}],ref:t.id+"-resizeBottomRight",style:{width:2*t.resizeHandleSize+"px",height:2*t.resizeHandleSize+"px",bottom:t.resizeHandleSize/-2+"px",right:t.resizeHandleSize/-2+"px",cursor:"nw-resize",position:"absolute",zIndex:t.resizableZIndex},attrs:{draggable:"",id:t.id+"-resizeBottomRight"},on:{onMouseDown:function(e){return t.onResizeStart(e,"bottom right")},onMouseUp:function(e){return t.onResizeEnd(e)}}},[t._t("resizeBottomRight")],2):t._e()]):t._e(),t._v(" "),t._t("default")],2):t._e()}),[],!1,null,null,null).exports;class g{constructor({breakpoint:t,numberOfCols:e,breakpointWidth:i,margin:s,autoHeight:r,keepSquare:n,useCssTransforms:h,width:o,height:a,rowHeight:d,compact:u}){this._itemBeingDragged=!1,this._itemBeingResized=!1,this._dashItems=[],this._dragStartListeners=[],this._dragListeners=[],this._dragEndListeners=[],this._resizeStartListeners=[],this._resizeListeners=[],this._resizeEndListeners=[],this._breakpoint=t,this._numberOfCols=e,this._breakpointWidth=void 0!==i?i:g.defaults.breakpointWidth,this._margin=void 0!==s?s:g.defaults.margin,this._autoHeight=void 0!==r?r:g.defaults.autoHeight,this._keepSquare=void 0!==n?n:g.defaults.keepSquare,this._useCssTransforms=void 0!==h?h:g.defaults.useCssTransforms,this._width=void 0!==o?o:g.defaults.width,this._height=void 0!==a?a:g.defaults.height,this._rowHeight=void 0!==d?d:g.defaults.rowHeight,this._compact=void 0!==u?u:g.defaults.compact}get breakpoint(){return this._breakpoint}set breakpoint(t){this._breakpoint=t}get breakpointWidth(){return this._breakpointWidth}set breakpointWidth(t){this._breakpointWidth=t}get margin(){return this._margin}set margin(t){this._margin=t}get width(){return this._width}set width(t){this._width=t,this.updateDashItems()}get height(){return this.autoHeight?this.calculateHeight():this._height}set height(t){this._height=t}get numberOfCols(){return this._numberOfCols}set numberOfCols(t){this._numberOfCols=t,this.updateDashItems()}get autoHeight(){return this._autoHeight}set autoHeight(t){this._autoHeight=t}get keepSquare(){return this._keepSquare}set keepSquare(t){this._keepSquare=t}get rowHeight(){return this.keepSquare?this.colWidth:this._rowHeight}set rowHeight(t){this._rowHeight=t}get colWidth(){return(this.width-this.margin.x*(this.numberOfCols+1))/this.numberOfCols}get itemBeingDragged(){return this._itemBeingDragged}set itemBeingDragged(t){this._itemBeingDragged=t}get itemBeingResized(){return this._itemBeingResized}set itemBeingResized(t){this._itemBeingResized=t}get placeholder(){return this.getDashItemById("-1Placeholder")}set placeholder(t){this.placeholder=t}get compact(){return this._compact}set compact(t){this._compact=t}calculateHeight(){let t=0,e=0;for(let i of this._dashItems)e=i.y+i.height,e>t&&(t=e);return t*(this.rowHeight+this.margin.y)+this.margin.y}addDashItem(t){this._dashItems.push(t),this.updateDashItems();let e=t.onDragStart.subscribe(t=>{this.itemDragging(t)});this._dragStartListeners.push({id:t.id,unsubscribe:e});let i=t.onDrag.subscribe(t=>{this.itemDragging(t)});this._dragListeners.push({id:t.id,unsubscribe:i});let s=t.onDragEnd.subscribe(t=>{this.itemDraggingComplete(t)});this._dragEndListeners.push({id:t.id,unsubscribe:s});let r=t.onResizeStart.subscribe(t=>{this.itemResizing(t)});this._resizeStartListeners.push({id:t.id,unsubscribe:r});let n=t.onResize.subscribe(t=>{this.itemResizing(t)});this._resizeListeners.push({id:t.id,unsubscribe:n});let h=t.onResizeEnd.subscribe(t=>{this.itemResizingComplete(t)});this._resizeEndListeners.push({id:t.id,unsubscribe:h});let o=this.compactLayout(this.items);this.syncItems(o)}removeDashItem(t){let e=this._dashItems.findIndex(e=>e.id===t.id);e>=0&&this._dashItems.splice(e,1),e=this._dragStartListeners.findIndex(e=>e.id===t.id),e>=0&&(this._dragStartListeners[e].unsubscribe(),this._dragStartListeners.splice(e,1)),e=this._dragListeners.findIndex(e=>e.id===t.id),e>=0&&(this._dragListeners[e].unsubscribe(),this._dragListeners.splice(e,1)),e=this._dragEndListeners.findIndex(e=>e.id===t.id),e>=0&&(this._dragEndListeners[e].unsubscribe(),this._dragEndListeners.splice(e,1)),e=this._resizeStartListeners.findIndex(e=>e.id===t.id),e>=0&&(this._resizeStartListeners[e].unsubscribe(),this._resizeStartListeners.splice(e,1)),e=this._resizeListeners.findIndex(e=>e.id===t.id),e>=0&&(this._resizeListeners[e].unsubscribe(),this._resizeListeners.splice(e,1)),e=this._resizeEndListeners.findIndex(e=>e.id===t.id),e>=0&&(this._resizeEndListeners[e].unsubscribe(),this._resizeEndListeners.splice(e,1))}getDashItemById(t){let e=this._dashItems.findIndex(e=>e.id===t);return e>=0?this._dashItems[e]:null}updateDashItems(){this._dashItems.forEach(t=>{t.colWidth=this.colWidth,t.rowHeight=this.rowHeight,t.margin=this.margin})}get items(){let t=[];return this._dashItems.forEach(e=>{t.push(e.toItem())}),t}itemDragging(t){this.itemBeingDragged||(this.placeholder.x=t.x,this.placeholder.y=t.y,this.placeholder.width=t.width,this.placeholder.height=t.height,this.itemBeingDragged=!0);let e=JSON.parse(JSON.stringify(this.items)).filter(e=>e.id!==t.id),i=e.findIndex(t=>t.id===this.placeholder.id);e=this.moveItem(e,e[i],h.getXFromLeft(t.left,this.colWidth,this.margin),h.getYFromTop(t.top,this.rowHeight,this.margin),!0),e=this.compactLayout(e),this.syncItems(e)}itemDraggingComplete(t){this.itemBeingDragged=!1;let e=this.getDashItemById(t.id);e&&(e.x=this.placeholder.x,e.y=this.placeholder.y),this.placeholder.x=0,this.placeholder.y=0,this.placeholder.width=0,this.placeholder.height=0}itemResizing(t){this.itemBeingResized=!0,this.placeholder.x=h.getXFromLeft(t.left,this.colWidth,this.margin),this.placeholder.y=h.getYFromTop(t.top,this.rowHeight,this.margin),this.placeholder.width=h.getWidthFromPx(t.widthPx,this.colWidth,this.margin),this.placeholder.height=h.getHeightFromPx(t.heightPx,this.rowHeight,this.margin);let e=JSON.parse(JSON.stringify(this.items)).filter(e=>e.id!==t.id),i=e.findIndex(t=>t.id===this.placeholder.id);e=this.moveItem(e,e[i],h.getXFromLeft(t.left,this.colWidth,this.margin),h.getYFromTop(t.top,this.rowHeight,this.margin),!0),e=this.compactLayout(e),this.syncItems(e)}itemResizingComplete(t){this.itemBeingResized=!1;let e=this.getDashItemById(t.id);e&&(e.x=this.placeholder.x,e.y=this.placeholder.y,e.width=this.placeholder.width,e.height=this.placeholder.height),this.placeholder.x=0,this.placeholder.y=0,this.placeholder.width=0,this.placeholder.height=0}checkForCollision(t,e){return t.id!==e.id&&(!(t.x+t.width<=e.x)&&(!(t.x>=e.x+e.width)&&(!(t.y+t.height<=e.y)&&!(t.y>=e.y+e.height))))}getFirstCollision(t,e){for(let i of t)if(this.checkForCollision(e,i))return i;return null}getAllCollisions(t,e){return t.filter(t=>this.checkForCollision(t,e))}correctItemBounds(t){return t.x+t.width>this.numberOfCols&&(t.x=this.numberOfCols-t.width),t.x<0&&(t.x=0),t.y<0&&(t.y=0),t.width>this.numberOfCols&&(t.x=0,t.width=this.numberOfCols),t}correctBounds(t){for(let e=0;e<t.length;e++)t[e]=this.correctItemBounds(t[e]);return t}compactLayout(t){const e=this.sortItems(t),i=[],s=Array(t.length);for(let r=0;r<e.length;r++){let n=e[r];n=this.compactItem(i,n),i.push(n),s[t.findIndex(t=>t.id===n.id)]=n,n.moved=!1}return s}compactItem(t,e){if(this.compact)for(;e.y>0&&!this.getFirstCollision(t,e);)e.y--;let i;for(;i=this.getFirstCollision(t,e);)e.y=i.y+i.height;return e}sortItems(t,e){let i=JSON.parse(JSON.stringify(t));return i.sort((t,e)=>t.y>e.y||t.y===e.y&&t.x>e.x?1:-1),e&&i.reverse(),i}moveItem(t,e,i,s,r){const n=e.y>s;e.x=i,e.y=s,e.moved=!0,e=this.correctItemBounds(e);const h=this.sortItems(t,n),o=this.getAllCollisions(h,e);for(let i of o){if(i.moved)continue;if(e.y>i.y&&e.y-i.y>i.height/4)continue;let s=t.findIndex(t=>t.id===i.id);t=this.moveItemFromCollision(t,e,t[s],r)}return t}moveItemFromCollision(t,e,i,s){if(s){const s={id:"-1fakeItem",x:i.x,y:i.y,width:i.width,height:i.height};if(s.y=Math.max(e.y-i.height,0),!this.getFirstCollision(t,s))return this.moveItem(t,i,i.x,s.y)}return this.moveItem(t,i,i.x,i.y+1)}syncItems(t){t.forEach(t=>{this.getDashItemById(t.id).fromItem(t)})}static get defaults(){return{numberOfCols:12,breakpointWidth:void 0,margin:{x:10,y:10},autoHeight:!0,keepSquare:!0,useCssTransforms:!1,width:400,height:400,rowHeight:200,compact:!0}}}var c={name:"DashLayout",inheritAttrs:!1,props:{breakpoint:{type:String,required:!0},breakpointWidth:{type:Number,default:g.defaults.breakpointWidth},numberOfCols:{type:Number,default:g.defaults.numberOfCols},useCssTransforms:{type:Boolean,default:g.defaults.useCssTransforms},compact:{type:Boolean,default:g.defaults.compact},debug:{type:Boolean,default:!1},margin:{type:Object,default:function(){return g.defaults.margin}}},components:{DashItem:l},data:function(){return{l:null,placeholderId:"-1Placeholder",placeholderY:0,placeholderHeight:0,unWatch:null}},provide:function(){var t=this;return{$layout:function(){return t.l}}},inject:{$dashboard:{default:null}},computed:{dashboard:function(){return this.$dashboard?this.$dashboard():null},currentBreakpoint:function(){return this.dashboard?this.dashboard.currentBreakpoint:""},dragging:function(){return this.l.itemBeingDragged},resizing:function(){return this.l.itemBeingResized},placeholder:function(){var t;return(null===(t=this.l)||void 0===t?void 0:t.placeholder)?this.l.placeholder.toItem():""},itemsFromLayout:function(){return this.l?this.l.items:[]},colWidth:function(){return this.l?this.l.colWidth:""},height:function(){return this.l?this.l.height+"px":"0px"}},methods:{createPropWatchers:function(){var t=this;Object.keys(this.$props).forEach((function(e){t.$watch(e,function(t,e){return{handler:function(e){this.l[t]!==e&&(this.l[t]=e)},deep:e}}(e,!0))}))}},mounted:function(){this.l=new g(this.$props),this.dashboard?(this.dashboard.addLayoutInstance(this.l),this.createPropWatchers()):this.unWatch=this.$watch("dashboard",(function(t){t&&(this.dashboard.addLayoutInstance(this.l),this.createPropWatchers(),this.unWatch())}),{immediate:!0})},beforeDestroy:function(){this.dashboard&&this.dashboard.removeLayoutInstance(this.l)}},p=(i(216),Object(u.a)(c,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return t.currentBreakpoint===t.breakpoint?i("div",[t.l?i("div",{style:{position:"relative",height:t.height}},[t._t("default"),t._v(" "),i("DashItem",{directives:[{name:"show",rawName:"v-show",value:t.dragging||t.resizing,expression:"dragging || resizing"}],attrs:{id:t.placeholderId,draggable:!1,resizable:!1,y:t.placeholderY,height:t.placeholderHeight},on:{"update:y":function(e){t.placeholderY=e},"update:height":function(e){t.placeholderHeight=e}}},[i("div",{staticClass:"placeholder"})])],2):t._e(),t._v(" "),t.debug?i("div",[t._v("\n    Layout Breakpoint: "+t._s(t.breakpoint)+" "),i("br"),t._v("\n    Current ColWidth: "+t._s(t.colWidth)+" "),i("br"),t._v("\n    Layout Number of Cols: "+t._s(t.numberOfCols)+" "),i("br"),t._v("\n    placeholder: "+t._s(JSON.stringify(t.placeholder))+" "),i("br"),t._v("\n    Items: "+t._s(JSON.stringify(t.itemsFromLayout))+" "),i("br"),t._v("\n    Height: "+t._s(t.height)+"\n  ")]):t._e()]):t._e()}),[],!1,null,null,null).exports);class m{constructor({id:t,autoHeight:e,width:i}){this._id=t,this._layouts=[],this._autoHeight=void 0!==e?e:m.defaults.autoHeight,this._width=void 0!==i?i:m.defaults.width}get id(){return this._id}get breakpoints(){let t=[];for(let e of this._layouts)t.push({name:e.breakpoint,numberOfCols:e.numberOfCols,setpoint:e.breakpointWidth});return t.sort((t,e)=>void 0!==t.setpoint&&void 0!==e.setpoint?+t.setpoint-+e.setpoint:void 0===t.setpoint?1:-1),t}get currentBreakpoint(){return this.updateCurrentBreakpoint()}get layouts(){return this._layouts}set layouts(t){this._layouts=t}get autoHeight(){return this._autoHeight}set autoHeight(t){this._autoHeight=t}get width(){return this._width}set width(t){this._width=t,this.updateCurrentBreakpoint(),this.updateLayouts()}updateCurrentBreakpoint(){if(0==this.breakpoints.length)return"";let t=this.breakpoints[0].name;for(let e=1;e<this.breakpoints.length;e++)void 0!==typeof this.breakpoints[e].setpoint&&this.width>this.breakpoints[e].setpoint&&(t=this.breakpoints[e].name);return t}sortBreakpoints(){this.breakpoints.sort((t,e)=>void 0!==t.setpoint&&void 0!==e.setpoint?+t.setpoint-+e.setpoint:void 0===t.setpoint?1:-1)}addLayoutInstance(t){this._layouts.push(t)}updateLayouts(){this._layouts.forEach(t=>{t.width=this.width})}removeLayoutInstance(t){let e=this.layouts.findIndex(e=>t.breakpoint===e.breakpoint);e>=0&&this._layouts.splice(e,1)}static get defaults(){return{autoHeight:!0,width:400}}}var f=i(217),z={name:"Dashboard",inheritAttrs:!1,props:{id:{type:[Number,String],required:!0},autoHeight:{type:Boolean,default:m.defaults.autoHeight}},directives:{rlocal:f.resize},data:function(){return{d:null}},provide:function(){var t=this;return{$dashboard:function(){return t.d}}},computed:{currentBreakpoint:function(){return this.d?this.d.currentBreakpoint:null}},watch:{currentBreakpoint:function(t){t&&this.$emit("currentBreakpointUpdated",t)}},methods:{onResize:function(t){this.d.width=t.detail.width},createPropWatchers:function(){var t=this;Object.keys(this.$props).forEach((function(e){t.$watch(e,function(t,e){return{handler:function(e){this.d[t]!==e&&(this.d[t]=e)},deep:e}}(e,!0))}))}},created:function(){this.d=new m(this.$props),this.createPropWatchers()}},_=Object(u.a)(z,(function(){var t=this.$createElement,e=this._self._c||t;return this.d?e("div",{directives:[{name:"rlocal",rawName:"v-rlocal"}],ref:this.id,attrs:{id:this.id},on:{resize:this.onResize}},[this._t("default")],2):this._e()}),[],!1,null,null,null).exports;i.d(e,"DashItem",(function(){return l})),i.d(e,"DashLayout",(function(){return p})),i.d(e,"Dashboard",(function(){return _}));var v={DashItem:l,DashLayout:p,Dashboard:_};Object.keys(v).forEach((function(t){s.a.component(t,v[t])}));e.default=v}}]);